@model IEnumerable<CinemaManagement.Models.Showtime>
@{
    ViewData["Title"] = "Danh sách suất chiếu";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
    .custom-card {
        background-color: #1c1c1c;
        color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        padding: 20px;
    }

    .custom-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #000;
        padding: 15px 20px;
        border-radius: 10px 10px 0 0;
        margin-bottom: 20px;
    }

        .custom-header h3 {
            color: #ff4d4d;
            margin: 0;
        }

    .btn-red {
        background-color: #ff4d4d;
        color: #fff;
        border: none;
    }

        .btn-red:hover {
            background-color: #e60000;
        }

    .table-dark-custom th, .table-dark-custom td {
        background-color: #2c2c2c;
        color: #fff;
        border-color: #444;
    }

    .text-danger {
        color: #ff6666 !important;
    }
</style>

<div class="custom-card">
    <div class="custom-header">
        <h3><i class="bi bi-film"></i> Danh sách suất chiếu</h3>
        <a asp-action="Create" asp-route-movieId="@ViewBag.MovieId" class="btn btn-primary">Thêm suất chiếu</a>
    </div>

    @if (ViewBag.MovieTitle != null)
    {
        <h5 class="text-muted mb-3">Phim: <strong>@ViewBag.MovieTitle</strong></h5>
    }

    <table class="table table-dark table-dark-custom table-bordered align-middle">
        <thead>
            <tr>
                <th>ID</th>
                <th>Phim</th>
                <th>Rạp</th>
                <th>Thời gian chiếu</th>
                <th>Giá vé</th>
                <th>Giảm giá (%)</th>
                <th>Hành động</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@item.ShowtimeId</td>
                    <td>@item.Movie?.Title</td>
                    <td>@item.Room?.Theater?.Name</td>
                    <td>@item.StartTime.ToString("dd/MM/yyyy HH:mm")</td>
                    <td>@item.Price.ToString("#,##0") VND</td>
                    <td>@item.DiscountPercent</td>
                    <td>
                        <a asp-action="Edit" asp-route-id="@item.ShowtimeId" class="btn btn-sm btn-warning">
                            <i class="bi bi-pencil"></i>
                        </a>

                        <button type="button" class="btn btn-sm btn-danger" onclick="confirmDelete(@item.ShowtimeId)">
                            <i class="bi bi-trash"></i>
                        </button>

                        <form id="deleteForm-@item.ShowtimeId" asp-action="Delete" asp-route-id="@item.ShowtimeId" method="post" style="display:none;">
                            @Html.AntiForgeryToken()
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="text-end mt-3">
        <a asp-controller="Manager" asp-action="Index" class="btn btn-outline-light">
            <i class="bi bi-arrow-left"></i> Quay lại danh sách phim
        </a>
    </div>
</div>

@section Scripts {
    <script>
        function confirmDelete(id) {
            if (confirm("Bạn có chắc muốn xóa suất chiếu này không?")) {
                document.getElementById('deleteForm-' + id).submit();
            }
        }
    </script>
}
